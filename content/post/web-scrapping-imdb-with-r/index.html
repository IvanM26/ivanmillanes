---
title: Creating a Movie Dataset with R
author: Ivan Millanes
date: '2020-05-27'
slug: movie-dataset-with-r
categories: []
tags:
  - R
  - IMDB
  - tidyverse
  - rvest
  - parallel
subtitle: ''
summary: "In this post, I'll show how I used R to create a movies dataset. I worked with IMDb (Internet Movie Database) data files available for download and information gathered through web scrapping their site."
authors: []
lastmod: '2020-05-27T09:16:31-03:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
bibliography: bibliography.bib
---

<script src="/rmarkdown-libs/kePrint/kePrint.js"></script>


<p>In this post, I’ll show how I used R to create a movies dataset. I worked with <a href="https://www.imdb.com/">IMDb (Internet Movie Database)</a> data files <a href="https://datasets.imdbws.com/">available for download</a> and information gathered through web scrapping their site.</p>
<div id="load-packages" class="section level1">
<h1>Load Packages</h1>
<p>The following packages need to be installed and loaded in order to run the code written in this post.</p>
<pre class="r"><code>library(tidyverse)
library(parallel)
library(rvest)
library(knitr)
library(kableExtra)</code></pre>
</div>
<div id="imdb-datasets" class="section level1">
<h1>IMDb Datasets</h1>
<p><a href="https://www.imdb.com/">IMDb (Internet Movie Database)</a> is an online database of information related to films, television programs, home videos, video games, and streaming content online – including cast, production crew and personal biographies, plot summaries, trivia, ratings, and fan and critical reviews <span class="citation">(Wikipedia contributors 2020)</span>.</p>
<p>Subsets of IMDb data are <a href="https://datasets.imdbws.com/">available</a> for access to customers for personal and non-commercial use.</p>
<div id="download" class="section level2">
<h2>Download</h2>
<p>I’ll download the following datasets:</p>
<ul>
<li><code>title.basics.tsv.gz</code></li>
<li><code>title.ratings.tsv.gz</code></li>
<li><code>title.crew.tsv.gz</code></li>
<li><code>name.basics.tsv.gz</code></li>
</ul>
<p>I’ll provide more information about them in the following sections.</p>
<details>
<summary>Code Details</summary>
The following code creates a folder named <code>data</code> if it doesn’t already exist where I’ll place the downloaded files. For the purpose of this post, the download of each file will proceed if the file hasn’t been downloaded yet. You should take into account that the downloaded files may change depending on when they are downloaded (as new information is available every day).
</details>
<pre class="r"><code># Create &quot;data&quot; folder if does not exist
if (!file.exists(&quot;data&quot;)) {
  dir.create(&quot;data&quot;)
}

# Download the files from IMDb if they haven&#39;t been downloaded
if (!file.exists(&quot;data/title.basics.tsv.gz&quot;)) {
download.file(&quot;https://datasets.imdbws.com/title.basics.tsv.gz&quot;,
              destfile = &quot;data/title.basics.tsv.gz&quot;)
}

if (!file.exists(&quot;data/title.ratings.tsv.gz&quot;)) {
download.file(&quot;https://datasets.imdbws.com/title.ratings.tsv.gz&quot;,
              destfile = &quot;data/title.ratings.tsv.gz&quot;)
}

if (!file.exists(&quot;data/title.crew.tsv.gz&quot;)) {
download.file(&quot;https://datasets.imdbws.com/title.crew.tsv.gz&quot;,
              destfile = &quot;data/title.crew.tsv.gz&quot;)
}

if (!file.exists(&quot;data/name.basics.tsv.gz&quot;)) {
download.file(&quot;https://datasets.imdbws.com/name.basics.tsv.gz&quot;,
              destfile = &quot;data/name.basics.tsv.gz&quot;)
}</code></pre>
</div>
<div id="description-load-and-inspection" class="section level2">
<h2>Description, Load and Inspection</h2>
<p>In this section I’ll describe what variables are included in each dataset, load them into R and take a look at their first few rows.</p>
<p>I created the following function to set the column width of a variable.</p>
<pre class="r"><code># Function to set kable column width
col_width &lt;- function(kable_input, data, col, width_min) {
  column_spec(kable_input = kable_input, 
              column = which( colnames(data) == enexpr(col) ), 
              width_min = width_min)
}</code></pre>
<div id="title.basics.tsv.gz" class="section level3">
<h3><code>title.basics.tsv.gz</code></h3>
<p>This dataset contains the following information:</p>
<ul>
<li><code>tconst</code> (string): alphanumeric unique identifier of the title</li>
<li><code>titleType</code> (string): the type/format of the title (e.g. movie, short, tvseries, tvepisode, video, etc)</li>
<li><code>primaryTitle</code> (string): the more popular title / the title used by the filmmakers on promotional materials at the point of release</li>
<li><code>originalTitle</code> (string): original title, in the original language</li>
<li><code>isAdult</code> (boolean):
<ul>
<li><code>0</code>: non-adult title;</li>
<li><code>1</code>: adult title</li>
</ul></li>
<li><code>startYear</code> (YYYY): represents the release year of a title. In the case of TV Series, it is the series start year</li>
<li><code>endYear</code> (YYYY): TV Series end year. ‘\N’ for all other title types</li>
<li><code>runtimeMinutes</code>: primary runtime of the title, in minutes</li>
<li><code>genres</code> (string array): includes up to three genres associated with the title</li>
</ul>
<p>I load the data.</p>
<pre class="r"><code># Load title.basics
title.basics &lt;- gzfile(&quot;data/title.basics.tsv.gz&quot;) %&gt;%
      read_delim(
            &quot;\t&quot;, 
            escape_double = FALSE, 
            na = &quot;\\N&quot;, 
            trim_ws = TRUE, 
            quote=&#39;&#39;,
            col_types = cols(
                  tconst = col_character(), 
                  titleType = col_character(),
                  primaryTitle = col_character(),
                  originalTitle = col_character(),
                  isAdult = col_logical(),
                  startYear = col_integer(),
                  endYear = col_integer(),                 
                  runtimeMinutes = col_integer(), 
                  genres = col_character()
                  )
            )</code></pre>
<p>This is how this dataset looks like.</p>
<pre class="r"><code>title.basics %&gt;%
  head %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(title.basics, tconst, &quot;3em&quot;) %&gt;%
  col_width(title.basics, titleType, &quot;3em&quot;) %&gt;%
  col_width(title.basics, primaryTitle, &quot;18em&quot;) %&gt;%
  col_width(title.basics, originalTitle, &quot;18em&quot;) %&gt;%
  col_width(title.basics, isAdult, &quot;3em&quot;) %&gt;%
  col_width(title.basics, startYear, &quot;3em&quot;) %&gt;%
  col_width(title.basics, endYear, &quot;3em&quot;) %&gt;%
  col_width(title.basics, runtimeMinutes, &quot;4em&quot;) %&gt;%
  col_width(title.basics, genres, &quot;5em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:left;">
titleType
</th>
<th style="text-align:left;">
primaryTitle
</th>
<th style="text-align:left;">
originalTitle
</th>
<th style="text-align:left;">
isAdult
</th>
<th style="text-align:right;">
startYear
</th>
<th style="text-align:right;">
endYear
</th>
<th style="text-align:right;">
runtimeMinutes
</th>
<th style="text-align:left;">
genres
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000001
</td>
<td style="text-align:left;min-width: 3em; ">
short
</td>
<td style="text-align:left;min-width: 18em; ">
Carmencita
</td>
<td style="text-align:left;min-width: 18em; ">
Carmencita
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1894
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
1
</td>
<td style="text-align:left;min-width: 5em; ">
Documentary,Short
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000002
</td>
<td style="text-align:left;min-width: 3em; ">
short
</td>
<td style="text-align:left;min-width: 18em; ">
Le clown et ses chiens
</td>
<td style="text-align:left;min-width: 18em; ">
Le clown et ses chiens
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1892
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
5
</td>
<td style="text-align:left;min-width: 5em; ">
Animation,Short
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000003
</td>
<td style="text-align:left;min-width: 3em; ">
short
</td>
<td style="text-align:left;min-width: 18em; ">
Pauvre Pierrot
</td>
<td style="text-align:left;min-width: 18em; ">
Pauvre Pierrot
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1892
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
4
</td>
<td style="text-align:left;min-width: 5em; ">
Animation,Comedy,Romance
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000004
</td>
<td style="text-align:left;min-width: 3em; ">
short
</td>
<td style="text-align:left;min-width: 18em; ">
Un bon bock
</td>
<td style="text-align:left;min-width: 18em; ">
Un bon bock
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1892
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
12
</td>
<td style="text-align:left;min-width: 5em; ">
Animation,Short
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000005
</td>
<td style="text-align:left;min-width: 3em; ">
short
</td>
<td style="text-align:left;min-width: 18em; ">
Blacksmith Scene
</td>
<td style="text-align:left;min-width: 18em; ">
Blacksmith Scene
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1893
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
1
</td>
<td style="text-align:left;min-width: 5em; ">
Comedy,Short
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000006
</td>
<td style="text-align:left;min-width: 3em; ">
short
</td>
<td style="text-align:left;min-width: 18em; ">
Chinese Opium Den
</td>
<td style="text-align:left;min-width: 18em; ">
Chinese Opium Den
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1894
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
1
</td>
<td style="text-align:left;min-width: 5em; ">
Short
</td>
</tr>
</tbody>
</table>
</div>
<div id="title.ratings.tsv.gz" class="section level3">
<h3><code>title.ratings.tsv.gz</code></h3>
<p>This dataset contains the following information:</p>
<ul>
<li><code>tconst</code> (string): alphanumeric unique identifier of the title</li>
<li><code>averageRating</code>: weighted average of all the individual user ratings</li>
<li><code>numVotes</code> - number of votes the title has received</li>
</ul>
<p>I load the data.</p>
<pre class="r"><code># Load title.ratings
title.ratings &lt;- gzfile(&quot;data/title.ratings.tsv.gz&quot;) %&gt;%
      read_delim(&quot;\t&quot;, 
                 escape_double = FALSE, 
                 na = &quot;\\N&quot;, 
                 trim_ws = TRUE, 
                 quote=&#39;&#39;,
                 col_types = cols(
                       tconst = col_character(), 
                       averageRating = col_double(),
                       numVotes = col_integer()
                       )
                 )</code></pre>
<p>This is how this dataset looks like.</p>
<pre class="r"><code>title.ratings %&gt;%
  head %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(title.ratings, tconst, &quot;3em&quot;) %&gt;%
  col_width(title.ratings, averageRating, &quot;3em&quot;) %&gt;%
  col_width(title.ratings, numVotes, &quot;3em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:right;">
averageRating
</th>
<th style="text-align:right;">
numVotes
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000001
</td>
<td style="text-align:right;min-width: 3em; ">
5.6
</td>
<td style="text-align:right;min-width: 3em; ">
1618
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000002
</td>
<td style="text-align:right;min-width: 3em; ">
6.0
</td>
<td style="text-align:right;min-width: 3em; ">
198
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000003
</td>
<td style="text-align:right;min-width: 3em; ">
6.5
</td>
<td style="text-align:right;min-width: 3em; ">
1298
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000004
</td>
<td style="text-align:right;min-width: 3em; ">
6.1
</td>
<td style="text-align:right;min-width: 3em; ">
122
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000005
</td>
<td style="text-align:right;min-width: 3em; ">
6.1
</td>
<td style="text-align:right;min-width: 3em; ">
2077
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0000006
</td>
<td style="text-align:right;min-width: 3em; ">
5.1
</td>
<td style="text-align:right;min-width: 3em; ">
112
</td>
</tr>
</tbody>
</table>
</div>
<div id="title.crew.tsv.gz" class="section level3">
<h3><code>title.crew.tsv.gz</code></h3>
<p>This dataset contains the following information:</p>
<ul>
<li><code>tconst</code> (string): alphanumeric unique identifier of the title</li>
<li><code>directors</code> (array of nconsts): director(s) of the given title</li>
<li><code>writers</code> (array of nconsts): writer(s) of the given title</li>
</ul>
<p>In this post, I’m not interested in <code>writers</code> information, so I won’t be loading that column.</p>
<p>I load the data.</p>
<pre class="r"><code># Load title.crew, skipping writers column
title.crew &lt;- gzfile(&quot;data/title.crew.tsv.gz&quot;) %&gt;%
      read_delim(&quot;\t&quot;, 
              escape_double = FALSE, 
              na = &quot;\\N&quot;, 
              trim_ws = TRUE, 
              quote=&#39;&#39;,
              col_types = cols(
                 tconst = col_character(),
                 directors = col_character(),
                 writers = col_skip()
                 )
              )</code></pre>
<p>This is how this dataset looks like.</p>
<pre class="r"><code>title.crew %&gt;%
  head(8) %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(title.crew, directors, &quot;14em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:left;">
directors
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
tt0000001
</td>
<td style="text-align:left;min-width: 14em; ">
nm0005690
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0000002
</td>
<td style="text-align:left;min-width: 14em; ">
nm0721526
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0000003
</td>
<td style="text-align:left;min-width: 14em; ">
nm0721526
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0000004
</td>
<td style="text-align:left;min-width: 14em; ">
nm0721526
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0000005
</td>
<td style="text-align:left;min-width: 14em; ">
nm0005690
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0000006
</td>
<td style="text-align:left;min-width: 14em; ">
nm0005690
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0000007
</td>
<td style="text-align:left;min-width: 14em; ">
nm0374658,nm0005690
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0000008
</td>
<td style="text-align:left;min-width: 14em; ">
nm0005690
</td>
</tr>
</tbody>
</table>
</div>
<div id="name.basics.tsv.gz" class="section level3">
<h3><code>name.basics.tsv.gz</code></h3>
<p>This dataset contains the following information:</p>
<ul>
<li><code>nconst</code> (string) - alphanumeric unique identifier of the name/person</li>
<li><code>primaryName</code> (string): name by which the person is most often credited</li>
<li><code>birthYear</code>: in YYYY format</li>
<li><code>deathYear</code>: in YYYY format if applicable, else ‘\N’</li>
<li><code>primaryProfession</code> (array of strings): the top-3 professions of the person</li>
<li><code>knownForTitles</code> (array of tconsts): titles the person is known for</li>
</ul>
<p>From this dataset, I’ll only use the first two columns (<code>nconst</code> and <code>primaryName</code>)</p>
<p>I load the data.</p>
<pre class="r"><code># Load name.basics
name.basics &lt;- gzfile(&quot;data/name.basics.tsv.gz&quot;) %&gt;%
      read_delim(&quot;\t&quot;, 
              escape_double = FALSE, 
              na = &quot;\\N&quot;, 
              trim_ws = TRUE, 
              quote=&#39;&#39;,
              col_types = cols(
                 nconst = col_character(),
                 primaryName = col_character(),
                 birthYear = col_skip(),
                 deathYear = col_skip(),
                 primaryProfession = col_skip(),
                 knownForTitles = col_skip()
                 )
              )</code></pre>
<p>This is how this dataset looks like.</p>
<pre class="r"><code>name.basics %&gt;%
  head %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(name.basics, nconst, &quot;3em&quot;) %&gt;%
  col_width(name.basics, primaryName, &quot;10em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
nconst
</th>
<th style="text-align:left;">
primaryName
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 3em; ">
nm0000001
</td>
<td style="text-align:left;min-width: 10em; ">
Fred Astaire
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
nm0000002
</td>
<td style="text-align:left;min-width: 10em; ">
Lauren Bacall
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
nm0000003
</td>
<td style="text-align:left;min-width: 10em; ">
Brigitte Bardot
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
nm0000004
</td>
<td style="text-align:left;min-width: 10em; ">
John Belushi
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
nm0000005
</td>
<td style="text-align:left;min-width: 10em; ">
Ingmar Bergman
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
nm0000006
</td>
<td style="text-align:left;min-width: 10em; ">
Ingrid Bergman
</td>
</tr>
</tbody>
</table>
<p>I’ll use this dataset to replace the name codes found in <code>title.crew</code>.</p>
</div>
</div>
</div>
<div id="movies-dataset---part-i" class="section level1">
<h1>Movies Dataset - Part I</h1>
<p>Let’s start the creation of our <code>movies</code> dataset.</p>
<p>In Part I, I’ll work with the datasets downloaded in the previous section to create a <code>movies</code> dataset that will contain information about <strong>movies</strong> with the following characteristics:</p>
<ul>
<li>have a release year (<code>startYear</code>) greater than or equal to 1970</li>
<li>have a runtime (<code>runtimeMinutes</code>) between 45m and 3h30min (210 min)</li>
<li>have an average rating (<code>averageRating</code>) greater than or equal to 4 on IMDb</li>
<li>at least 2500 votes (<code>numVotes</code>) on IMDb</li>
</ul>
<p>The following code takes <code>title.basics</code>, applies some filters, adds <code>title.ratings</code> information, applies some filters again and finally, creates a new column, <code>linkTitle</code>, which contains the html code necessary to link a movie to its IMDb website.</p>
<details>
<p><summary>Code Details</summary>
This is what the code does:</p>
<ul>
<li>Begin with <code>title.basics</code> dataset.</li>
<li>Filter titles with:
<ul>
<li><code>titleType == "movie"</code>,</li>
<li><code>startYear &gt;= 1970</code></li>
<li><code>runtimeMinutes &gt;= 45 &amp; runtimeMinutes &lt;= 210</code>.</li>
</ul></li>
<li>Add ratings information from <code>title.ratings</code>.</li>
<li>Delete duplicate titles.</li>
<li>Filter titles with:
<ul>
<li><code>averageRating &gt;= 4</code>,</li>
<li><code>numVotes &gt;= 2500</code></li>
</ul></li>
<li>Create <code>linkTitle</code> column.</li>
</ul>
If you want to change any of the parameters I defined in the filters, you can do it!
</details>
<pre class="r"><code># Creation of the movies dataset
movies &lt;- title.basics %&gt;%
  
  # Apply filters
      filter(
            titleType == &quot;movie&quot;,
            startYear &gt;= 1970,
            runtimeMinutes &gt;= 45 &amp; runtimeMinutes &lt;= 210
            ) %&gt;%
  
  # Add ratings and votes
  left_join(title.ratings, by = &quot;tconst&quot;) %&gt;%
  
  # Remove duplicates
      distinct(tconst, .keep_all = TRUE) %&gt;%
  
  # Apply filters
      filter(
            averageRating &gt;= 4,
            numVotes &gt;= 2500
      ) %&gt;%
  # Create linkTitle
   mutate(
     linkTitle = str_c(
       &quot;&lt;a href=&#39;https://www.imdb.com/title/&quot;, tconst, &quot;/&#39;&gt;&quot;, originalTitle,&quot;&lt;/a&gt;&quot;)
     )</code></pre>
<p>Let’s take a look at our dataset so far.</p>
<pre class="r"><code>movies %&gt;%
  head %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(movies, tconst, &quot;3em&quot;) %&gt;%
  col_width(movies, titleType, &quot;3em&quot;) %&gt;%
  col_width(movies, primaryTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, originalTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, isAdult, &quot;3em&quot;) %&gt;%
  col_width(movies, startYear, &quot;3em&quot;) %&gt;%
  col_width(movies, endYear, &quot;3em&quot;) %&gt;%
  col_width(movies, runtimeMinutes, &quot;4em&quot;) %&gt;%
  col_width(movies, genres, &quot;5em&quot;) %&gt;%
  col_width(movies, averageRating, &quot;3em&quot;) %&gt;%
  col_width(movies, numVotes, &quot;3em&quot;) %&gt;%
  col_width(movies, linkTitle, &quot;45em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:left;">
titleType
</th>
<th style="text-align:left;">
primaryTitle
</th>
<th style="text-align:left;">
originalTitle
</th>
<th style="text-align:left;">
isAdult
</th>
<th style="text-align:right;">
startYear
</th>
<th style="text-align:right;">
endYear
</th>
<th style="text-align:right;">
runtimeMinutes
</th>
<th style="text-align:left;">
genres
</th>
<th style="text-align:right;">
averageRating
</th>
<th style="text-align:right;">
numVotes
</th>
<th style="text-align:left;">
linkTitle
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0035423
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
2001
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
118
</td>
<td style="text-align:left;min-width: 5em; ">
Comedy,Fantasy,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
6.4
</td>
<td style="text-align:right;min-width: 3em; ">
77127
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0035423/&#39;%3EKate" class="uri">https://www.imdb.com/title/tt0035423/'&gt;Kate</a> &amp; Leopold&lt;/a&gt;
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064106
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Le Boucher
</td>
<td style="text-align:left;min-width: 18em; ">
Le boucher
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
93
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7348
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064106/&#39;%3ELe" class="uri">https://www.imdb.com/title/tt0064106/'&gt;Le</a> boucher&lt;/a&gt;
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064165
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Things of Life
</td>
<td style="text-align:left;min-width: 18em; ">
Les choses de la vie
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
89
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.6
</td>
<td style="text-align:right;min-width: 3em; ">
3664
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064165/&#39;%3ELes" class="uri">https://www.imdb.com/title/tt0064165/'&gt;Les</a> choses de la vie&lt;/a&gt;
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064177
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
100
</td>
<td style="text-align:left;min-width: 5em; ">
Sci-Fi,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.1
</td>
<td style="text-align:right;min-width: 3em; ">
7860
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064177/&#39;%3EColossus" class="uri">https://www.imdb.com/title/tt0064177/'&gt;Colossus</a>: The Forbin Project&lt;/a&gt;
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064285
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Wild Child
</td>
<td style="text-align:left;min-width: 18em; ">
L’enfant sauvage
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
83
</td>
<td style="text-align:left;min-width: 5em; ">
Drama
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7238
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064285/&#39;%3EL&#39;enfant" class="uri">https://www.imdb.com/title/tt0064285/'&gt;L'enfant</a> sauvage&lt;/a&gt;
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064437
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
107
</td>
<td style="text-align:left;min-width: 5em; ">
Crime,Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.0
</td>
<td style="text-align:right;min-width: 3em; ">
4229
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064437/&#39;%3EThe" class="uri">https://www.imdb.com/title/tt0064437/'&gt;The</a> Honeymoon Killers&lt;/a&gt;
</td>
</tr>
</tbody>
</table>
<p>To finish Part I, I’ll add <code>directors</code> information to our <code>movies</code> dataset.</p>
<p>This would have been pretty straightforward if <code>title.crew</code> had directors’ names instead of codes. As that’s not the case, some preprocessing is going to be necessary. Also, the fact that when a title has more than one director they are comma-separated in the same cell adds certain complexity to the task of replacing codes with names. But be not afraid, because the <code>tidyverse</code> is going to help us with this task!</p>
<p>The following code applies the desired change to <code>title.crew</code>.</p>
<details>
<p><summary>Code Details</summary>
This is what the code does:</p>
<ul>
<li>Begin with <code>title.crew</code> dataset.</li>
<li>Keep crew that corresponds to titles in <code>movies</code> to speed up calculations</li>
<li>Go from a dataset where we have one row per title with comma-separated directors codes, to a dataset where we have one row per director code, indicating the title they directed. This step creates a longer dataset which will have duplicate <code>tconst</code> values for titles with more than one director.</li>
<li>Add the name by directors’ code.</li>
<li>Return to a dataset with one row per title and comma-separated named directors.</li>
</ul>
</details>
<pre class="r"><code>title.crew &lt;- title.crew %&gt;%
  
  # Keep crew from titles in movies
   semi_join(movies, &quot;tconst&quot;) %&gt;%
  
  # One row for each director
   separate_rows(directors, sep = &quot;,&quot;) %&gt;%
  
  # Add name
   left_join(name.basics, by = c(&quot;directors&quot; = &quot;nconst&quot;)) %&gt;%
  
  # Return to semicolon separated values
   group_by(tconst) %&gt;%
   summarise(directors = str_c(primaryName, collapse = &quot;;&quot;)) %&gt;%
   ungroup()</code></pre>
<p>Let’s see how <code>title.crew</code> looks like now.</p>
<pre class="r"><code>title.crew %&gt;%
  head(8) %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(title.crew, directors, &quot;18em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:left;">
directors
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
tt0035423
</td>
<td style="text-align:left;min-width: 18em; ">
James Mangold
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0064106
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Chabrol
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0064165
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Sautet
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0064177
</td>
<td style="text-align:left;min-width: 18em; ">
Joseph Sargent
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0064285
</td>
<td style="text-align:left;min-width: 18em; ">
François Truffaut
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0064437
</td>
<td style="text-align:left;min-width: 18em; ">
Donald Volkman;Leonard Kastle
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0064451
</td>
<td style="text-align:left;min-width: 18em; ">
King Hu
</td>
</tr>
<tr>
<td style="text-align:left;">
tt0064791
</td>
<td style="text-align:left;min-width: 18em; ">
René Clément
</td>
</tr>
</tbody>
</table>
<p>Now we can add this to <code>movies</code>.</p>
<pre class="r"><code># Add the column to movies
movies &lt;- movies %&gt;%
   left_join(title.crew, by = &quot;tconst&quot;)</code></pre>
<p>This is how <code>movies</code> looks like in the end of Part I.</p>
<pre class="r"><code>movies %&gt;%
  head %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(movies, tconst, &quot;3em&quot;) %&gt;%
  col_width(movies, titleType, &quot;3em&quot;) %&gt;%
  col_width(movies, primaryTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, originalTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, isAdult, &quot;3em&quot;) %&gt;%
  col_width(movies, startYear, &quot;3em&quot;) %&gt;%
  col_width(movies, endYear, &quot;3em&quot;) %&gt;%
  col_width(movies, runtimeMinutes, &quot;4em&quot;) %&gt;%
  col_width(movies, genres, &quot;5em&quot;) %&gt;%
  col_width(movies, averageRating, &quot;3em&quot;) %&gt;%
  col_width(movies, numVotes, &quot;3em&quot;) %&gt;%
  col_width(movies, linkTitle, &quot;45em&quot;) %&gt;%
  col_width(movies, directors, &quot;18em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:left;">
titleType
</th>
<th style="text-align:left;">
primaryTitle
</th>
<th style="text-align:left;">
originalTitle
</th>
<th style="text-align:left;">
isAdult
</th>
<th style="text-align:right;">
startYear
</th>
<th style="text-align:right;">
endYear
</th>
<th style="text-align:right;">
runtimeMinutes
</th>
<th style="text-align:left;">
genres
</th>
<th style="text-align:right;">
averageRating
</th>
<th style="text-align:right;">
numVotes
</th>
<th style="text-align:left;">
linkTitle
</th>
<th style="text-align:left;">
directors
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0035423
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
2001
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
118
</td>
<td style="text-align:left;min-width: 5em; ">
Comedy,Fantasy,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
6.4
</td>
<td style="text-align:right;min-width: 3em; ">
77127
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0035423/&#39;%3EKate" class="uri">https://www.imdb.com/title/tt0035423/'&gt;Kate</a> &amp; Leopold&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
James Mangold
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064106
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Le Boucher
</td>
<td style="text-align:left;min-width: 18em; ">
Le boucher
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
93
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7348
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064106/&#39;%3ELe" class="uri">https://www.imdb.com/title/tt0064106/'&gt;Le</a> boucher&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Chabrol
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064165
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Things of Life
</td>
<td style="text-align:left;min-width: 18em; ">
Les choses de la vie
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
89
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.6
</td>
<td style="text-align:right;min-width: 3em; ">
3664
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064165/&#39;%3ELes" class="uri">https://www.imdb.com/title/tt0064165/'&gt;Les</a> choses de la vie&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Sautet
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064177
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
100
</td>
<td style="text-align:left;min-width: 5em; ">
Sci-Fi,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.1
</td>
<td style="text-align:right;min-width: 3em; ">
7860
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064177/&#39;%3EColossus" class="uri">https://www.imdb.com/title/tt0064177/'&gt;Colossus</a>: The Forbin Project&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Joseph Sargent
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064285
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Wild Child
</td>
<td style="text-align:left;min-width: 18em; ">
L’enfant sauvage
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
83
</td>
<td style="text-align:left;min-width: 5em; ">
Drama
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7238
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064285/&#39;%3EL&#39;enfant" class="uri">https://www.imdb.com/title/tt0064285/'&gt;L'enfant</a> sauvage&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
François Truffaut
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064437
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
107
</td>
<td style="text-align:left;min-width: 5em; ">
Crime,Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.0
</td>
<td style="text-align:right;min-width: 3em; ">
4229
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064437/&#39;%3EThe" class="uri">https://www.imdb.com/title/tt0064437/'&gt;The</a> Honeymoon Killers&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Donald Volkman;Leonard Kastle
</td>
</tr>
</tbody>
</table>
</div>
<div id="movies-dataset---part-ii" class="section level1">
<h1>Movies Dataset - Part II</h1>
<p>So far so good. We used the downloaded files to create a <code>movies</code> dataset with a lot of information about movies with certain characteristics. But what if we want even <strong>more</strong> information?</p>
<div id="web-scrapping-imdb" class="section level2">
<h2>Web scrapping IMDb</h2>
<p>If we take a look at any movie website in IMDb (for example, <a href="https://www.imdb.com/title/tt0468569/">this one</a>), we see that there is a lot more information related to that movie. I’m particularly interested in the following:</p>
<ul>
<li><a href="https://www.imdb.com/list/ls051211184/">Metascore</a></li>
<li>The place or places where the production companies for that title are based, and therefore where the financing originated (Country)</li>
<li>Estimated production cost of the movie (Budget)</li>
<li>How much the movie took at the box office in the USA in its first weekend of release (Opening Weekend USA)</li>
<li>How much the movie made at the box office in USA (Gross USA)</li>
<li>How much the movie made at the box office all over the world, including the USA (Worldwide Gross)</li>
<li>Awards information</li>
<li>Full cast</li>
</ul>
<p>How can we add that information to our dataset? Now is when <em>web scrapping</em> joins the party. I’ll use the <code>rvest</code> package to extract the information mentioned above for each movie (when available). Also, as we have to do this for 16191 movies, I’ll be using the <code>parallel</code> package to speed up the work. Even with this approach, the code took around one hour and a half to run.</p>
<p>The following code creates an object named <code>scrapping</code> that contains the information we want for each movie. Some preprocessing is going to be necessary before adding new columns to <code>movies</code>, but I’ll talk about it later.</p>
<details>
<p><summary>Code Details</summary>
I had to retrieve information for a lot of movies, and look for it in two different websites (because full cast data wasn’t in the same title page as the other information). For that reason, I decided to run my code in <code>parallel</code>.</p>
<p>The first part of the code sets up clusters to run the work in parallel. I defined the number of cores to be used equal to the number of cores in my computer (it has eight cores) minus one, because that’s what is recommended. So I created seven clusters. Remember to stop the clusters when you finish the work.</p>
<p>I load the necessary libraries to run the code in each cluster by using the <code>clusterEvalQ</code> function. I assigned the result of that function to <code>junk</code> to prevent the print of some output.</p>
<p>Then we have the extraction function itself. The difference is that instead of using <code>apply</code>, we use <code>parLapply</code>.</p>
<p>The object <code>scrapping</code> consists of a list of elements with length equal to the number of movies scrapped, and each element of this list is a list of elements (the returned <code>my_list</code> object for each movie).</p>
<p>The scrapping part is somewhat straightforward. We read the html, we select nodes and extract the text.</p>
<p>There is one final consideration regarding the scrapping of box office information. Based on how the information is structured on IMDb, in this step I extracted more data than necessary. For each movie, the <code>scrap_boxOffice</code> object is a character vector whose length may vary from movie to movie (because not all movies have all data available) and each element of that vector contains different data. I’ll manage to keep the information I want and assign it to the corresponding vector in the next section.</p>
Even though I tried to be as clear as possible, this might be a little confusing, but I hope that by inspecting the code you’ll get what is doing!
</details>
<pre class="r"><code># Web scrapping more information about movies

# Set the cluster to work in parallel
n_cores &lt;- detectCores() - 1
clust &lt;- makeCluster(n_cores)

# Load packages on each cluster
# Obs: library() returns a character vector of all the attached packages, but
# it does so invisibly. When executed via clusterEvalQ, it isn&#39;t invisible.
# To make it &quot;invisible&quot; again, I assigned the result of clusterEvalQ to junk. 

junk &lt;- clusterEvalQ(clust, {
  library(dplyr)
  library(stringr)
  library(rvest)
})

# Create scrapping object by running a parallel apply
scrapping &lt;- parLapply(clust, movies$tconst, function(x){
  
  # Read title page
  title_page &lt;- read_html(str_c(&quot;https://www.imdb.com/title/&quot;, x)) 
  
  # Scrap metascore
  scrap_metascore &lt;- title_page %&gt;%
    html_nodes(&quot;.metacriticScore span&quot;) %&gt;%
    html_text
  
  # Scrap box office (and country)
  scrap_boxOffice &lt;- title_page %&gt;%
    html_nodes(&quot;.txt-block&quot;) %&gt;%
    html_text
  
  # Scrap awards
  scrap_awards &lt;- title_page %&gt;%
    html_nodes(&quot;.awards-blurb b&quot;) %&gt;%
    html_text
  
  
  # Read cast page
  cast_page &lt;- read_html(
    str_c(&quot;https://www.imdb.com/title/&quot;, x, &quot;/fullcredits?ref_=tt_cl_sm#cast&quot;)
    )
  
  # Scrap cast
  scrap_cast &lt;- cast_page %&gt;%
    html_nodes(&quot;.primary_photo+ td a&quot;) %&gt;%
    html_text %&gt;%
    str_c(collapse = &quot;;&quot;) %&gt;%
    str_replace_all(&quot;\\n&quot;, &quot;&quot;)
  
  # Output for each movie
  my_list &lt;- list(&quot;scrap_cast&quot; = scrap_cast,
                  &quot;scrap_metascore&quot; = scrap_metascore,
                  &quot;scrap_boxOffice&quot; = scrap_boxOffice,
                  &quot;scrap_awards&quot; = scrap_awards)
  return(my_list)
})

# Stop the cluster
stopCluster(clust)</code></pre>
</div>
<div id="vector-assignment" class="section level2">
<h2>Vector Assignment</h2>
<p>The following code uses the <code>scrapping</code> object to create the vectors of data that will be used to add columns to <code>movies</code>.</p>
<details>
<p><summary>Code Details</summary>
This is what the code does:</p>
<ul>
<li>Preallocates the corresponding vectors</li>
<li>Creates <code>no_lenght_zero</code> function to solve an issue realted to how data is scrapped when there is no information</li>
<li>Fills preallocated vectors</li>
</ul>
<code>boxOffice_list</code> is a character vector where each element refers to a different type of data. It is somewhat structured though, so I used a combination of <code>keep</code> and <code>str_detect</code> functions to assign each target data to the corresponding vector.
</details>
<pre class="r"><code># Number of movies
n_movies &lt;- nrow(movies)

# Preallocate vectors
scrap_cast &lt;- vector(&quot;character&quot;, length = n_movies)

scrap_metascore &lt;- vector(&quot;character&quot;, length = n_movies)

scrap_country &lt;- vector(&quot;character&quot;, length = n_movies)
scrap_budget &lt;- vector(&quot;character&quot;, length = n_movies)
scrap_open_usa &lt;- vector(&quot;character&quot;, length = n_movies)
scrap_gross_usa &lt;- vector(&quot;character&quot;, length = n_movies)
scrap_gross_world &lt;- vector(&quot;character&quot;, length = n_movies)

scrap_awards &lt;- vector(&quot;character&quot;, length = n_movies)

# Function to fix length zero problem
no_lenght_zero &lt;- function(x){
  ifelse(identical(x, character(0)), NA_character_, x)
}

# Assign extracted info
for (i in seq_along(scrapping)){
  
  scrap_cast[[i]] &lt;- scrapping[[i]][[&quot;scrap_cast&quot;]] %&gt;%
    no_lenght_zero
  
  scrap_metascore[[i]] &lt;- scrapping[[i]][[&quot;scrap_metascore&quot;]] %&gt;%
    no_lenght_zero
  
  boxOffice_list &lt;- scrapping[[i]][[&quot;scrap_boxOffice&quot;]]
  
  scrap_country[[i]] &lt;- boxOffice_list %&gt;%
    keep(~ str_detect(.x, &quot;Country:&quot;)) %&gt;%
    no_lenght_zero
  scrap_budget[[i]] &lt;- boxOffice_list %&gt;%
    keep(~ str_detect(.x, &quot;Budget:&quot;)) %&gt;%
    no_lenght_zero
  scrap_open_usa[[i]] &lt;- boxOffice_list %&gt;%
    keep(~ str_detect(.x, &quot;Opening Weekend USA:&quot;)) %&gt;%
    no_lenght_zero
  scrap_gross_usa[[i]] &lt;- boxOffice_list %&gt;%
    keep(~ str_detect(.x, &quot;Gross USA:&quot;)) %&gt;%
    no_lenght_zero
  scrap_gross_world[[i]] &lt;- boxOffice_list %&gt;%
    keep(~ str_detect(.x, &quot;Cumulative Worldwide Gross:&quot;)) %&gt;%
    no_lenght_zero
  
  scrap_awards[[i]] &lt;- scrapping[[i]][[&quot;scrap_awards&quot;]] %&gt;%
    no_lenght_zero
}</code></pre>
</div>
<div id="add-columns" class="section level2">
<h2>Add columns</h2>
<p>Finally, we can use <code>mutate</code> to add the new columns to <code>movies</code>.</p>
<pre class="r"><code># Add scrapped columns to data
movies &lt;- movies %&gt;%
  mutate(cast = scrap_cast,
         metascore_raw = scrap_metascore,
         country_raw = scrap_country,
         budget_raw = scrap_budget,
         open_usa_raw = scrap_open_usa,
         gross_usa_raw = scrap_gross_usa,
         gross_world_raw = scrap_gross_world,
         awards_raw = scrap_awards)</code></pre>
<p>This is how <code>movies</code> looks like in the end of Part II.</p>
<p>Obs: I have taken the first 30 characters of cast to make the table look better.</p>
<pre class="r"><code>movies %&gt;%
  head %&gt;%
  mutate(cast = cast %&gt;%
           str_sub(1, 30) %&gt;%
           str_c(&quot;...&quot;)) %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(movies, tconst, &quot;3em&quot;) %&gt;%
  col_width(movies, titleType, &quot;3em&quot;) %&gt;%
  col_width(movies, primaryTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, originalTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, isAdult, &quot;3em&quot;) %&gt;%
  col_width(movies, startYear, &quot;3em&quot;) %&gt;%
  col_width(movies, endYear, &quot;3em&quot;) %&gt;%
  col_width(movies, runtimeMinutes, &quot;4em&quot;) %&gt;%
  col_width(movies, genres, &quot;5em&quot;) %&gt;%
  col_width(movies, averageRating, &quot;3em&quot;) %&gt;%
  col_width(movies, numVotes, &quot;3em&quot;) %&gt;%
  col_width(movies, linkTitle, &quot;45em&quot;) %&gt;%
  col_width(movies, directors, &quot;18em&quot;) %&gt;%
  col_width(movies, cast, &quot;18em&quot;) %&gt;%
  col_width(movies, metascore_raw, &quot;3em&quot;) %&gt;%
  col_width(movies, country_raw, &quot;20em&quot;) %&gt;%
  col_width(movies, budget_raw, &quot;18em&quot;) %&gt;%
  col_width(movies, open_usa_raw, &quot;28em&quot;) %&gt;%
  col_width(movies, gross_usa_raw, &quot;18em&quot;) %&gt;%
  col_width(movies, gross_world_raw, &quot;25em&quot;) %&gt;%
  col_width(movies, awards_raw, &quot;18em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:left;">
titleType
</th>
<th style="text-align:left;">
primaryTitle
</th>
<th style="text-align:left;">
originalTitle
</th>
<th style="text-align:left;">
isAdult
</th>
<th style="text-align:right;">
startYear
</th>
<th style="text-align:right;">
endYear
</th>
<th style="text-align:right;">
runtimeMinutes
</th>
<th style="text-align:left;">
genres
</th>
<th style="text-align:right;">
averageRating
</th>
<th style="text-align:right;">
numVotes
</th>
<th style="text-align:left;">
linkTitle
</th>
<th style="text-align:left;">
directors
</th>
<th style="text-align:left;">
cast
</th>
<th style="text-align:left;">
metascore_raw
</th>
<th style="text-align:left;">
country_raw
</th>
<th style="text-align:left;">
budget_raw
</th>
<th style="text-align:left;">
open_usa_raw
</th>
<th style="text-align:left;">
gross_usa_raw
</th>
<th style="text-align:left;">
gross_world_raw
</th>
<th style="text-align:left;">
awards_raw
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0035423
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
2001
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
118
</td>
<td style="text-align:left;min-width: 5em; ">
Comedy,Fantasy,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
6.4
</td>
<td style="text-align:right;min-width: 3em; ">
77127
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0035423/&#39;%3EKate" class="uri">https://www.imdb.com/title/tt0035423/'&gt;Kate</a> &amp; Leopold&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
James Mangold
</td>
<td style="text-align:left;min-width: 18em; ">
Meg Ryan; Hugh Jackman; Liev …
</td>
<td style="text-align:left;min-width: 3em; ">
44
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
USA
</td>
<td style="text-align:left;min-width: 18em; ">
Budget:$48,000,000
(estimated)
</td>
<td style="text-align:left;min-width: 28em; ">
Opening Weekend USA: $9,725,408,
30 December 2001
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $47,121,859
</td>
<td style="text-align:left;min-width: 25em; ">
Cumulative Worldwide Gross: $76,019,048
</td>
<td style="text-align:left;min-width: 18em; ">
Nominated for
1
Oscar.
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064106
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Le Boucher
</td>
<td style="text-align:left;min-width: 18em; ">
Le boucher
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
93
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7348
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064106/&#39;%3ELe" class="uri">https://www.imdb.com/title/tt0064106/'&gt;Le</a> boucher&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Chabrol
</td>
<td style="text-align:left;min-width: 18em; ">
Stéphane Audran; Jean Yanne; …
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
France
|
Italy
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $474,458
</td>
<td style="text-align:left;min-width: 25em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
Nominated for
1
BAFTA Film Award.
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064165
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Things of Life
</td>
<td style="text-align:left;min-width: 18em; ">
Les choses de la vie
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
89
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.6
</td>
<td style="text-align:right;min-width: 3em; ">
3664
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064165/&#39;%3ELes" class="uri">https://www.imdb.com/title/tt0064165/'&gt;Les</a> choses de la vie&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Sautet
</td>
<td style="text-align:left;min-width: 18em; ">
Michel Piccoli; Romy Schneide…
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
Switzerland
|
France
|
Italy
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $5,063
</td>
<td style="text-align:left;min-width: 25em; ">
Cumulative Worldwide Gross: $5,063
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064177
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
100
</td>
<td style="text-align:left;min-width: 5em; ">
Sci-Fi,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.1
</td>
<td style="text-align:right;min-width: 3em; ">
7860
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064177/&#39;%3EColossus" class="uri">https://www.imdb.com/title/tt0064177/'&gt;Colossus</a>: The Forbin Project&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Joseph Sargent
</td>
<td style="text-align:left;min-width: 18em; ">
Eric Braeden; Susan Clark; Go…
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
USA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 25em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064285
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Wild Child
</td>
<td style="text-align:left;min-width: 18em; ">
L’enfant sauvage
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
83
</td>
<td style="text-align:left;min-width: 5em; ">
Drama
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7238
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064285/&#39;%3EL&#39;enfant" class="uri">https://www.imdb.com/title/tt0064285/'&gt;L'enfant</a> sauvage&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
François Truffaut
</td>
<td style="text-align:left;min-width: 18em; ">
Jean-Pierre Cargol; François …
</td>
<td style="text-align:left;min-width: 3em; ">
94
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
France
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
Opening Weekend USA: $11,206,
25 April 1999
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $65,560
</td>
<td style="text-align:left;min-width: 25em; ">
Cumulative Worldwide Gross: $65,560
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064437
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
107
</td>
<td style="text-align:left;min-width: 5em; ">
Crime,Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.0
</td>
<td style="text-align:right;min-width: 3em; ">
4229
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064437/&#39;%3EThe" class="uri">https://www.imdb.com/title/tt0064437/'&gt;The</a> Honeymoon Killers&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Donald Volkman;Leonard Kastle
</td>
<td style="text-align:left;min-width: 18em; ">
Shirley Stoler; Tony Lo Bianc…
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
USA
</td>
<td style="text-align:left;min-width: 18em; ">
Budget:$150,000
(estimated)
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 25em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="movies-dataset---part-iii" class="section level1">
<h1>Movies Dataset - Part III</h1>
<p>In Part III, I’ll clean the columns created in Part II.</p>
<div id="metascore" class="section level2">
<h2>Metascore</h2>
<p><code>metascore_raw</code> is a character column. I used <code>parse_number</code> to create <code>metascore</code>, which is numeric.</p>
<pre class="r"><code># metascore to number
movies &lt;- movies %&gt;%
  mutate(metascore = metascore_raw %&gt;%
           parse_number)</code></pre>
</div>
<div id="country" class="section level2">
<h2>Country</h2>
<p><code>country_raw</code> needs some cleaning that can be done with <code>stringr::str_replace_all</code> function.</p>
<pre class="r"><code>movies &lt;- movies %&gt;%
  mutate(country = country_raw %&gt;%
           str_replace_all(&quot;Country:&quot;, &quot;&quot;) %&gt;%
           str_replace_all(&quot;\\n&quot;, &quot;&quot;) %&gt;%
           str_replace_all(&quot; &quot;, &quot;&quot;) %&gt;%
           str_replace_all(&quot;\\|&quot;, &quot;;&quot;)
)</code></pre>
</div>
<div id="box-office-information" class="section level2">
<h2>Box Office Information</h2>
<p>By taking a fast look at this “money” variables, it seemed that the currency was dollars ($). Just to be sure, I created the function <code>check_currency</code> with the following logic: if the sum of values where I find the dollar sign ($) and <code>NA</code> values of a column is equal to the total number of rows, then all currencies are the same (and dollars).</p>
<pre class="r"><code>check_currency &lt;- function(data, col) {
  n_movies &lt;- nrow(data)
  missing &lt;- data %&gt;%
    pull(enexpr(col)) %&gt;%
    is.na %&gt;%
    sum
  
  dollar_sign &lt;- data %&gt;%
    pull(enexpr(col)) %&gt;%
    str_detect(&quot;\\$&quot;) %&gt;%
    sum(na.rm = TRUE)
  
  identical(missing + dollar_sign, n_movies)
}</code></pre>
<p>After applying this function to the corresponding columns, we see that not all currencies are the same. Later I checked the dataset and saw in fact that this was the case.</p>
<pre class="r"><code>check_currency(movies, budget_raw)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>check_currency(movies, open_usa_raw)</code></pre>
<pre><code>## [1] TRUE</code></pre>
<pre class="r"><code>check_currency(movies, gross_usa_raw)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<pre class="r"><code>check_currency(movies, gross_world_raw)</code></pre>
<pre><code>## [1] FALSE</code></pre>
<p>I decided to keep only those values express in dollars, assigning <code>NA</code> otherwise. For that matter, I created the <code>keep_dollar</code> function.</p>
<pre class="r"><code>keep_dollar &lt;- function(col) {
  ifelse(str_detect(col, &quot;\\$&quot;), col, NA_real_)
}</code></pre>
<p>Now we can create our new variables, through <code>parse_number</code>. This function works just fine, even with columns where there were more numbers present (for example, take a look at <code>open_usa_raw</code> and <code>open_usa</code>)</p>
<pre class="r"><code>movies &lt;- movies %&gt;%
  mutate(budget = keep_dollar(budget_raw) %&gt;%
           parse_number,
         open_usa = keep_dollar(open_usa_raw) %&gt;%
           parse_number,
         gross_usa = keep_dollar(gross_usa_raw) %&gt;%
           parse_number,
         gross_world = keep_dollar(gross_world_raw) %&gt;%
           parse_number)</code></pre>
</div>
<div id="awards-information" class="section level2">
<h2>Awards information</h2>
<p>Using the <code>awards_raw</code> column I created a few variables.</p>
<p>For <strong>every</strong> movie:</p>
<ul>
<li><code>won_oscar</code>, an indicator variable that takes the value 1 if the movie won any Oscar and 0 otherwise</li>
<li><code>oscars_won</code>, the number of Oscars won by a movie</li>
</ul>
<p>For movies that <strong>didn’t win an Oscar</strong>:</p>
<ul>
<li><code>nominated_oscar</code>, an indicator variable that takes the value 1 if the movie was nominated for any Oscar and 0 otherwise</li>
<li><code>oscars_nominations</code>, the number of Oscar nominations</li>
</ul>
<p>Obs: If a movie won at least one Oscar, we don’t know how many nominations it had. This has to do with the way I scrapped this data.</p>
<pre class="r"><code>movies &lt;- movies %&gt;%
  mutate(
    
    won_oscar = ifelse(
      test = str_detect(awards_raw, &quot;Won&quot;) &amp; 
        str_detect(awards_raw, &quot;Oscar&quot;) &amp;
        !is.na(awards_raw), 
      yes = 1, 
      no = 0
      ),
    
    oscars_won = ifelse(
      test = won_oscar == 1, 
      yes = parse_number(awards_raw),
      no = 0
    ),
    
    nominated_oscar = ifelse(
      test = str_detect(awards_raw, &quot;Nominated&quot;) &amp; 
        str_detect(awards_raw, &quot;Oscar&quot;) &amp;
        !is.na(awards_raw), 
      yes = 1, 
      no = 0
    ),
    
    oscars_nominations = ifelse(
      test = nominated_oscar == 1, 
      yes = parse_number(awards_raw),
      no = 0
    )
)</code></pre>
<p>The final dataset looks like this. I kept the raw columns for you to see the differences with the cleaned ones.</p>
<pre class="r"><code>movies %&gt;%
  head %&gt;%
  mutate(cast = cast %&gt;%
           str_sub(1, 30) %&gt;%
           str_c(&quot;...&quot;)) %&gt;%
  kable(format = &quot;html&quot;, table.attr = &quot;style = \&quot;color: white;\&quot;&quot;) %&gt;%
  col_width(movies, tconst, &quot;3em&quot;) %&gt;%
  col_width(movies, titleType, &quot;3em&quot;) %&gt;%
  col_width(movies, primaryTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, originalTitle, &quot;18em&quot;) %&gt;%
  col_width(movies, isAdult, &quot;3em&quot;) %&gt;%
  col_width(movies, startYear, &quot;3em&quot;) %&gt;%
  col_width(movies, endYear, &quot;3em&quot;) %&gt;%
  col_width(movies, runtimeMinutes, &quot;4em&quot;) %&gt;%
  col_width(movies, genres, &quot;5em&quot;) %&gt;%
  col_width(movies, averageRating, &quot;3em&quot;) %&gt;%
  col_width(movies, numVotes, &quot;3em&quot;) %&gt;%
  col_width(movies, linkTitle, &quot;45em&quot;) %&gt;%
  col_width(movies, directors, &quot;18em&quot;) %&gt;%
  col_width(movies, cast, &quot;18em&quot;) %&gt;%
  col_width(movies, metascore_raw, &quot;3em&quot;) %&gt;%
  col_width(movies, country_raw, &quot;20em&quot;) %&gt;%
  col_width(movies, budget_raw, &quot;18em&quot;) %&gt;%
  col_width(movies, open_usa_raw, &quot;28em&quot;) %&gt;%
  col_width(movies, gross_usa_raw, &quot;18em&quot;) %&gt;%
  col_width(movies, gross_world_raw, &quot;25em&quot;) %&gt;%
  col_width(movies, awards_raw, &quot;18em&quot;) %&gt;%
  col_width(movies, metascore, &quot;3em&quot;) %&gt;%
  col_width(movies, country, &quot;9em&quot;) %&gt;%
  col_width(movies, budget, &quot;7em&quot;) %&gt;%
  col_width(movies, open_usa, &quot;7em&quot;) %&gt;%
  col_width(movies, gross_usa, &quot;7em&quot;) %&gt;%
  col_width(movies, gross_world, &quot;7em&quot;) %&gt;%
  col_width(movies, won_oscar, &quot;10em&quot;) %&gt;%
  col_width(movies, oscars_won, &quot;10em&quot;) %&gt;%
  col_width(movies, nominated_oscar, &quot;10em&quot;) %&gt;%
  col_width(movies, oscars_nominations, &quot;10em&quot;)</code></pre>
<table style="color: white;">
<thead>
<tr>
<th style="text-align:left;">
tconst
</th>
<th style="text-align:left;">
titleType
</th>
<th style="text-align:left;">
primaryTitle
</th>
<th style="text-align:left;">
originalTitle
</th>
<th style="text-align:left;">
isAdult
</th>
<th style="text-align:right;">
startYear
</th>
<th style="text-align:right;">
endYear
</th>
<th style="text-align:right;">
runtimeMinutes
</th>
<th style="text-align:left;">
genres
</th>
<th style="text-align:right;">
averageRating
</th>
<th style="text-align:right;">
numVotes
</th>
<th style="text-align:left;">
linkTitle
</th>
<th style="text-align:left;">
directors
</th>
<th style="text-align:left;">
cast
</th>
<th style="text-align:left;">
metascore_raw
</th>
<th style="text-align:left;">
country_raw
</th>
<th style="text-align:left;">
budget_raw
</th>
<th style="text-align:left;">
open_usa_raw
</th>
<th style="text-align:left;">
gross_usa_raw
</th>
<th style="text-align:left;">
gross_world_raw
</th>
<th style="text-align:left;">
awards_raw
</th>
<th style="text-align:right;">
metascore
</th>
<th style="text-align:left;">
country
</th>
<th style="text-align:right;">
budget
</th>
<th style="text-align:right;">
open_usa
</th>
<th style="text-align:right;">
gross_usa
</th>
<th style="text-align:right;">
gross_world
</th>
<th style="text-align:right;">
won_oscar
</th>
<th style="text-align:right;">
oscars_won
</th>
<th style="text-align:right;">
nominated_oscar
</th>
<th style="text-align:right;">
oscars_nominations
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0035423
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 18em; ">
Kate &amp; Leopold
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
2001
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
118
</td>
<td style="text-align:left;min-width: 5em; ">
Comedy,Fantasy,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
6.4
</td>
<td style="text-align:right;min-width: 3em; ">
77127
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0035423/&#39;%3EKate" class="uri">https://www.imdb.com/title/tt0035423/'&gt;Kate</a> &amp; Leopold&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
James Mangold
</td>
<td style="text-align:left;min-width: 18em; ">
Meg Ryan; Hugh Jackman; Liev …
</td>
<td style="text-align:left;min-width: 3em; ">
44
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
USA
</td>
<td style="text-align:left;min-width: 18em; ">
Budget:$48,000,000
(estimated)
</td>
<td style="text-align:left;min-width: 28em; ">
Opening Weekend USA: $9,725,408,
30 December 2001
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $47,121,859
</td>
<td style="text-align:left;min-width: 25em; ">
Cumulative Worldwide Gross: $76,019,048
</td>
<td style="text-align:left;min-width: 18em; ">
Nominated for
1
Oscar.
</td>
<td style="text-align:right;min-width: 3em; ">
44
</td>
<td style="text-align:left;min-width: 9em; ">
USA
</td>
<td style="text-align:right;min-width: 7em; ">
4.8e+07
</td>
<td style="text-align:right;min-width: 7em; ">
9725408
</td>
<td style="text-align:right;min-width: 7em; ">
47121859
</td>
<td style="text-align:right;min-width: 7em; ">
76019048
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
1
</td>
<td style="text-align:right;min-width: 10em; ">
1
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064106
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Le Boucher
</td>
<td style="text-align:left;min-width: 18em; ">
Le boucher
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
93
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7348
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064106/&#39;%3ELe" class="uri">https://www.imdb.com/title/tt0064106/'&gt;Le</a> boucher&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Chabrol
</td>
<td style="text-align:left;min-width: 18em; ">
Stéphane Audran; Jean Yanne; …
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
France
|
Italy
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $474,458
</td>
<td style="text-align:left;min-width: 25em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
Nominated for
1
BAFTA Film Award.
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 9em; ">
France;Italy
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
474458
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064165
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Things of Life
</td>
<td style="text-align:left;min-width: 18em; ">
Les choses de la vie
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
89
</td>
<td style="text-align:left;min-width: 5em; ">
Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.6
</td>
<td style="text-align:right;min-width: 3em; ">
3664
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064165/&#39;%3ELes" class="uri">https://www.imdb.com/title/tt0064165/'&gt;Les</a> choses de la vie&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Claude Sautet
</td>
<td style="text-align:left;min-width: 18em; ">
Michel Piccoli; Romy Schneide…
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
Switzerland
|
France
|
Italy
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $5,063
</td>
<td style="text-align:left;min-width: 25em; ">
Cumulative Worldwide Gross: $5,063
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 9em; ">
Switzerland;France;Italy
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
5063
</td>
<td style="text-align:right;min-width: 7em; ">
5063
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064177
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 18em; ">
Colossus: The Forbin Project
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
100
</td>
<td style="text-align:left;min-width: 5em; ">
Sci-Fi,Thriller
</td>
<td style="text-align:right;min-width: 3em; ">
7.1
</td>
<td style="text-align:right;min-width: 3em; ">
7860
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064177/&#39;%3EColossus" class="uri">https://www.imdb.com/title/tt0064177/'&gt;Colossus</a>: The Forbin Project&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Joseph Sargent
</td>
<td style="text-align:left;min-width: 18em; ">
Eric Braeden; Susan Clark; Go…
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
USA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 25em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 9em; ">
USA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064285
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Wild Child
</td>
<td style="text-align:left;min-width: 18em; ">
L’enfant sauvage
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
83
</td>
<td style="text-align:left;min-width: 5em; ">
Drama
</td>
<td style="text-align:right;min-width: 3em; ">
7.5
</td>
<td style="text-align:right;min-width: 3em; ">
7238
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064285/&#39;%3EL&#39;enfant" class="uri">https://www.imdb.com/title/tt0064285/'&gt;L'enfant</a> sauvage&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
François Truffaut
</td>
<td style="text-align:left;min-width: 18em; ">
Jean-Pierre Cargol; François …
</td>
<td style="text-align:left;min-width: 3em; ">
94
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
France
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 28em; ">
Opening Weekend USA: $11,206,
25 April 1999
</td>
<td style="text-align:left;min-width: 18em; ">
Gross USA: $65,560
</td>
<td style="text-align:left;min-width: 25em; ">
Cumulative Worldwide Gross: $65,560
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:right;min-width: 3em; ">
94
</td>
<td style="text-align:left;min-width: 9em; ">
France
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
11206
</td>
<td style="text-align:right;min-width: 7em; ">
65560
</td>
<td style="text-align:right;min-width: 7em; ">
65560
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
</tr>
<tr>
<td style="text-align:left;min-width: 3em; ">
tt0064437
</td>
<td style="text-align:left;min-width: 3em; ">
movie
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 18em; ">
The Honeymoon Killers
</td>
<td style="text-align:left;min-width: 3em; ">
FALSE
</td>
<td style="text-align:right;min-width: 3em; ">
1970
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:right;min-width: 4em; ">
107
</td>
<td style="text-align:left;min-width: 5em; ">
Crime,Drama,Romance
</td>
<td style="text-align:right;min-width: 3em; ">
7.0
</td>
<td style="text-align:right;min-width: 3em; ">
4229
</td>
<td style="text-align:left;min-width: 45em; ">
&lt;a href=’<a href="https://www.imdb.com/title/tt0064437/&#39;%3EThe" class="uri">https://www.imdb.com/title/tt0064437/'&gt;The</a> Honeymoon Killers&lt;/a&gt;
</td>
<td style="text-align:left;min-width: 18em; ">
Donald Volkman;Leonard Kastle
</td>
<td style="text-align:left;min-width: 18em; ">
Shirley Stoler; Tony Lo Bianc…
</td>
<td style="text-align:left;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 20em; ">
Country:
USA
</td>
<td style="text-align:left;min-width: 18em; ">
Budget:$150,000
(estimated)
</td>
<td style="text-align:left;min-width: 28em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:left;min-width: 25em; ">
NA
</td>
<td style="text-align:left;min-width: 18em; ">
NA
</td>
<td style="text-align:right;min-width: 3em; ">
NA
</td>
<td style="text-align:left;min-width: 9em; ">
USA
</td>
<td style="text-align:right;min-width: 7em; ">
1.5e+05
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 7em; ">
NA
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
<td style="text-align:right;min-width: 10em; ">
0
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="subproducts" class="section level1">
<h1>Subproducts</h1>
<p>With a few lines of codes, some useful datasets can be created.</p>
<ul>
<li>List of different genres found in <code>movies</code></li>
</ul>
<pre class="r"><code>genres_list &lt;- movies %&gt;%
   select(genres) %&gt;%
   separate_rows(genres, sep = &quot;,&quot;) %&gt;%
   unique</code></pre>
<ul>
<li>List of different directors found in <code>movies</code></li>
</ul>
<pre class="r"><code>director_list &lt;- movies %&gt;%
  select(directors) %&gt;%
  separate_rows(directors, sep = &quot;;&quot;) %&gt;%
  unique</code></pre>
<ul>
<li>List of different actors and actresses found in <code>movies</code></li>
</ul>
<pre class="r"><code>cast_list &lt;- movies %&gt;%
  select(cast) %&gt;%
  separate_rows(cast, sep = &quot;;&quot;) %&gt;%
  unique</code></pre>
<div id="refs" class="references">
<div id="ref-wiki:imdb">
<p>Wikipedia contributors. 2020. “IMDb — Wikipedia, the Free Encyclopedia.” <a href="https://en.wikipedia.org/w/index.php?title=IMDb&amp;oldid=959154715">https://en.wikipedia.org/w/index.php?title=IMDb&amp;oldid=959154715</a>.</p>
</div>
</div>
</div>
